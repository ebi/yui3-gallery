YUI.add("gallery-dispatcher-database",function(h){var g="dispatcher",f="database",c=g+"-"+f,e="storeResponse",d="databaseManager",b="content",a="host";h.namespace("Dispatcher").database=h.Base.create(c,h.Plugin.Base,[],{initializer:function(i){if(!!window.openDatabase){if(h.Lang.isUndefined(this.get(d))){this.set(d,new h.DatabaseManager({}));}this.onHostEvent("uriChange",this._getContent,this);}},_getContent:function(k){k.halt();var i=k.newVal,j=this.get(a);this.get(d).getItem(i,h.bind(function(l){if(null!==l){j.set(b,l.value);}else{if((!h.Lang.isUndefined(navigator.onLine))&&false===navigator.onLine){this.fire("offlineAndNotCached");return;}else{h.io(i,{on:{success:this._storeContent},context:this,"arguments":{url:i}});}}},this));},_storeContent:function(k,i,j){if(this.get(e)){this.get(d).setItem(j.url,i.responseText);}this.get(a).set(b,i.responseText);}},{NS:f,ATTRS:{databaseManager:{},storeResponse:{value:true,validator:h.Lang.isBool}}});},"@VERSION@",{requires:["base-build","plugin","io-base","gallery-dispatcher","gallery-database-manager"]});